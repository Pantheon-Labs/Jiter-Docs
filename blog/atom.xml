<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://docs.jiter.dev/blog</id>
    <title>Jiter Docs Blog</title>
    <updated>2022-11-20T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://docs.jiter.dev/blog"/>
    <subtitle>Jiter Docs Blog</subtitle>
    <icon>https://docs.jiter.dev/img/jiter_favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Schedule SendGrid emails 72+ hours in the future via Jiter]]></title>
        <id>schedule-sendgrid-email-with-jiter</id>
        <link href="https://docs.jiter.dev/blog/schedule-sendgrid-email-with-jiter"/>
        <updated>2022-11-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Use Jiter to delay your email delivery by more than 3 days, bypassing SendGrid API limitations]]></summary>
        <content type="html"><![CDATA[<div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy">‚è±Ô∏è</span>TL;DR</div><div class="admonitionContent_S0QG"><p>We'll do our best to keep this short and sweet, but if you don't have the time, here's the gist:</p><p>SendGrid only allows for the scheduling of emails up to<!-- --> <strong>three days</strong>. Use <a href="https://jiter.dev" target="_blank" rel="noopener noreferrer">Jiter</a> and schedule emails weeks/months in advance with less than 30 lines of code!</p></div></div><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem">The Problem<a class="hash-link" href="#the-problem" title="Direct link to heading">‚Äã</a></h2><p>If you're trying to send a transactional email via SendGrid, <a href="https://docs.sendgrid.com/for-developers/sending-email/scheduling-parameters" target="_blank" rel="noopener noreferrer">you can delay it by a <strong>maximum</strong> of 72 hours</a>:</p><p><img loading="lazy" alt="sendgrid 72 hour delay limit" src="/assets/images/72-Hour-Limitation-dfe0ae4ec4639df6620880a5845fd25a.png" width="2590" height="488" class="img_ev3q"></p><p>What if you want to delay it more than that? What if you want to send an email to that user 7 days after joining? What if you need to reevaluate whether you <em>should</em> send the email at that time?</p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-solution">The Solution<a class="hash-link" href="#the-solution" title="Direct link to heading">‚Äã</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy">üîé</span>Follow Along!</div><div class="admonitionContent_S0QG"><p>Check out our<!-- --> <a href="https://github.com/SpencerKaiser/Jiter-Sendgrid-Example" target="_blank" rel="noopener noreferrer">example repo on GitHub</a> <!-- -->which includes code snippets you can use in your own project!</p></div></div><p>As you might have already guessed, the solution can be implemented in just nine simple steps (<em>that aren't actually simple</em>):</p><ol><li>Create a cron job manager in your app to initialize all cron jobs on app start<ul><li>[<em>Pause to question your architectural decisions and sanity</em>]</li></ul></li><li>Create a new database table to keep track of user notifications (i.e., who needs to get notified and when)<ul><li><em>Or you can just add another column, because your database can take another one for the team</em></li></ul></li><li>Create a cron job that checks your new table for any relevant records in order to determine who should be notified<ul><li><em>And subsequently overburden your DB server with a super heavy query when the job runs because you forgot that indexes are a thing</em></li></ul></li><li>Spend 45 minutes creating a <a href="https://crontab.guru/" target="_blank" rel="noopener noreferrer">cron expression</a> to schedule your cron job<ul><li><em>All while recognizing the similarity to Regular Expressions, having a panic attack, and then accidentally setting your cron job to run 60 times per hour instead of once per hour</em></li></ul></li><li>Ensure that you are locking rows properly so your don't perform redundant tasks on multiple instances of the app (.e.g., sending the same user two notifications)<ul><li><em>You <strong>are</strong> running multiple instances of the app, right?!</em></li></ul></li><li>Ensure that no two cron jobs referencing the same table run concurrently so they don't skip locked rows and exit prematurely<ul><li><em>Alternatively, you can skip this step and spend 6 hours debugging why a user record was apparently ignored</em></li></ul></li><li>Take a break to reevaluate your career choices<ul><li><em>This was probably on your schedule already</em></li></ul></li><li>Push your changes <em>straight to production</em><ul><li><em><code>#yolo</code></em></li></ul></li><li>Realize your jobs are not running at your desired time because you forgot about timezones<ul><li><em>Because you deployed to <code>us-east-1</code>... <a href="https://www.lastweekinaws.com/blog/lessons-in-trust-from-us-east-1/" target="_blank" rel="noopener noreferrer">misery loves company</a></em></li></ul></li></ol><p><strong>That's it! It's <em>THAT</em> simple üöÄ</strong></p><p><img loading="lazy" alt="there has to be a better way gif with Joey from FRIENDS" src="/assets/images/joey-better-way-2965456e6a28fca76f56d691570aa4a3.gif" width="456" height="371" class="img_ev3q"></p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-actual-solution">The Actual Solution<a class="hash-link" href="#the-actual-solution" title="Direct link to heading">‚Äã</a></h2><p>Use Jiter üòâ</p><p>But seriously, Jiter provides <strong>Just In Time (JIT)</strong> webhooks: you tell Jiter when you need to be reminded and what to remind you with, and we handle the rest.</p><p>To bypass this limitation with the SendGrid API, you can simply create an event with Jiter including a payload that will provide context (like what user to notify and what to notify them about), and then setup a webhook handler to actually trigger the email when the event is received.</p><p><img loading="lazy" alt="Paulie Walnuts from The Sopranos describing Jiter" src="/assets/images/paulie-5e8ea22bf6c4617dd4be834adcdaaccc.png" width="425" height="247" class="img_ev3q"></p><p>If you want to send an email to a new user seven days after they join your platform, simply create a Jiter event with a <code>scheduledTime</code> 7 days from now and include information about that user (like an ID) in the payload. 7 days later, we'll send a request to your app and you can trigger the email to be immediately sent! It's that simple.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-build-it">Let's Build It...<a class="hash-link" href="#lets-build-it" title="Direct link to heading">‚Äã</a></h2><p>The steps below describe how to use Jiter to schedule the delivery of an email one week after an API event takes place. Our example repo has the following components which are described in detail below:</p><ul><li>An API endpoint to track the intent of purchasing grocery items</li><li>The creation of a Jiter event to remind the user to restock groceries 7 days later</li><li>A handler which receives the Jiter webhook event and triggers an email to SendGrid (which will be delivered 7 days after the initial event)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-jiter-auth">1. Jiter Auth<a class="hash-link" href="#1-jiter-auth" title="Direct link to heading">‚Äã</a></h3><p>Check out our <a href="/getting-started">Getting Started</a> page which walks you through the creation of your first org and how to get your API Key and Signing Secret.</p><p>The <strong>API Key</strong> is used for authenticating <em>YOUR</em> requests and the <strong>Signing Secret</strong> helps you verify the authenticity of <em>OUR</em> webhook requests when we send them to your app.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy">üõ†Ô∏è</span>Try the API</div><div class="admonitionContent_S0QG"><p>We recently launched the<!-- --> <a href="https://app.jiter.dev" target="_blank" rel="noopener noreferrer">Jiter Playground</a>! You can create and receive events without setting anything up locally ü§Ø Check out our</p><img loading="lazy" alt="An image showing the Jiter playground user interface" src="/img/playground.png" class="img_ev3q"></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-sendgrid-auth">2. SendGrid Auth<a class="hash-link" href="#2-sendgrid-auth" title="Direct link to heading">‚Äã</a></h3><ul><li><a href="https://app.sendgrid.com/settings/api_keys" target="_blank" rel="noopener noreferrer">Go to the API Keys page</a> (or log in to SendGrid, go to <code>Settings</code> on the left sidebar, and click on <code>API keys</code>)</li><li>Click <code>Create API Key</code> in the top-right</li><li>Choose <code>Restricted Access</code> and enable the <code>Mail Send</code> permission:
<img loading="lazy" alt="SendGrid mail send permissions" src="data:image/png;base64,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" width="1315" height="183" class="img_ev3q"></li><li>Copy your API key for use later</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-jiter-setup">3. Jiter Setup<a class="hash-link" href="#3-jiter-setup" title="Direct link to heading">‚Äã</a></h3><p>As mentioned earlier, we created an <a href="https://github.com/SpencerKaiser/Jiter-Sendgrid-Example" target="_blank" rel="noopener noreferrer">example repository</a>; fork it and use it as a guide! You can copy snippets from that repo or follow our docs to configure the app your way.</p><p>The steps in the <code>README.md</code> are pretty straightforward, they involve setting up your credentials in a <code>.env</code> file and it's using <a href="https://ngrok.com" target="_blank" rel="noopener noreferrer">ngrok</a> to allow your local machine to receive events from our servers.
If you don't want to set anything up locally you can use our <a href="https://app.jiter.dev" target="_blank" rel="noopener noreferrer">Playground</a> and if you're looking for a custom URL, we recommend <a href="https://requestcatcher.com" target="_blank" rel="noopener noreferrer"><code>requestcatcher.com</code></a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="updating-an-existing-app">Updating an Existing App<a class="hash-link" href="#updating-an-existing-app" title="Direct link to heading">‚Äã</a></h4><p>If you're solving this problem within an existing app, use the example repo as a guide and make sure to do the following:</p><ul><li>Install the <a href="https://www.npmjs.com/package/@jiter/node" target="_blank" rel="noopener noreferrer"><code>@jiter/node</code> SDK</a> (<code>npm i @jiter/node</code> or <code>yarn add @jiter/node</code>)</li><li><a href="https://github.com/SpencerKaiser/Jiter-Sendgrid-Example/blob/7c78f77bc6e6f9345103e635a66bea2aab7ec434/src/index.ts#L22-L25" target="_blank" rel="noopener noreferrer">Initialize the Jiter SDK</a></li><li>Replicate the functionality from the next two sections (<a href="#4-scheduling-events">Scheduling Events</a> and <a href="#5-handling-webhook-events">Handling&nbsp;Webhook Events</a>) to create Jiter events and handle webhook events</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-scheduling-events">4. Scheduling Events<a class="hash-link" href="#4-scheduling-events" title="Direct link to heading">‚Äã</a></h3><p>The creation of an event is pretty simple via the Jiter SDK: just provide values for <code>scheduledTime</code> (when to deliver the webhook event), <code>payload</code> (what you want to receive as part of that event), and <code>destination</code> (the URL where we should send the <code>POST</code> request).</p><p>In our example (within the <a href="https://github.com/SpencerKaiser/Jiter-Sendgrid-Example/blob/main/src/api/events/post.ts" target="_blank" rel="noopener noreferrer"><code>POST /api/events</code> handler</a>), we handle the API intent of purchasing groceries but added functionality to remind the user <code>7 days</code> later to restock:</p><p><img loading="lazy" alt="Code snippet showing how to create an event with Jiter" src="/assets/images/Create-Reminder-418adf8666698eda23bd1b236294d6d9.png" width="1846" height="1200" class="img_ev3q"></p><p>The snippet above is an abstraction of the example repo: we send an email confirming the user's intent to purchase groceries and then use the <code>createEvent</code> method from the SDK to schedule a reminder set for 7 days later (which will send an event to <code>/api/webhooks/reminders</code>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-handling-webhook-events">5. Handling Webhook Events<a class="hash-link" href="#5-handling-webhook-events" title="Direct link to heading">‚Äã</a></h3><p>It's <code>7 days</code> later now... the future is here ü§ñ</p><p>When the webhook event comes to our app, we need to handle the request and take action using the <code>payload</code> as context.</p><p>In our example (within the <a href="https://github.com/SpencerKaiser/Jiter-Sendgrid-Example/blob/main/src/api/webhooks/reminders.ts" target="_blank" rel="noopener noreferrer"><code>POST api/webhooks/reminders</code> handler</a>) we use the <code>Middleware</code> method from the Jiter SDK to create a handler that accepts the request, verifies its authenticity, sends back a <code>200</code> status, and then provides the parsed payload:</p><p><img loading="lazy" alt="The Webhook method from the Jiter SDK" src="/assets/images/Webhook-Handler-9e7a42d6372e8db4c5ee3752291b1666.png" width="1690" height="588" class="img_ev3q"></p><p>Now that we're ready to receive the reminder event, we need to implement some business logic to send the restock reminder email:</p><p><img loading="lazy" alt="Jiter webhook handler implementation" src="/assets/images/Handler-Implementation-93884f4dfac41a133e1c6c55dc8a3b5e.png" width="2048" height="948" class="img_ev3q"></p><p>Because <code>parse: true</code> was passed to the <code>Middleware</code> method as an option, our <code>payload</code> was automatically parsed as JSON and we're able to safely deconstruct the <code>items</code> and <code>email</code> for use in our reminder email.</p><p>Tada! That's how you can use Jiter to schedule delayed emails with SendGrid and bypass the 72 hour limit.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-did-you-think">What did you think?<a class="hash-link" href="#what-did-you-think" title="Direct link to heading">‚Äã</a></h2><p>Was this blog post helpful? Do you regret your decision to skip past the TL;DR and read anyways? Did you have an epiphany and choose to pursue your dreams of baking?</p><p>Our team is eager to hear from you and help however we can. Get in touch with us via the <a href="https://discord.com/invite/NPC6GBDBXp" target="_blank" rel="noopener noreferrer"><strong>Jiter Discord Server</strong></a> or <a href="https://calendly.com/jiter/demo" target="_blank" rel="noopener noreferrer"><strong>schedule time to chat with our dev team</strong></a>!</p><br><br><br><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Still reading? We appreciate you... click here for your reward.</summary><div><div class="collapsibleContent_i85q"><h3>Thanks for reading ‚ù§Ô∏è</h3><img loading="lazy" src="/blog/schedule-sendgrid/c-a-t.png" class="img_ev3q"></div></div></details>]]></content>
        <author>
            <name>Jose Valerio</name>
            <uri>https://github.com/joswayski</uri>
        </author>
        <author>
            <name>Spencer Kaiser</name>
            <uri>https://github.com/SpencerKaiser</uri>
        </author>
        <category label="sendgrid" term="sendgrid"/>
        <category label="jiter" term="jiter"/>
        <category label="delay" term="delay"/>
        <category label="schedule" term="schedule"/>
        <category label="email" term="email"/>
        <category label="api" term="api"/>
        <category label="webhooks" term="webhooks"/>
    </entry>
</feed>